<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Jupyter Notebooks :: Serving an LLM using OpenShift AI</title>
    <link rel="prev" href="index.html">
    <link rel="next" href="section2.html">
    <meta name="generator" content="Antora 3.1.3">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://www.redhat.com" target="_blank"><img src="../../../_/img/redhat-logo.png" height="40px" alt="Red Hat"></a>
      <a class="navbar-item" style="font-size: 24px; color: white" href="../../..">Serving an LLM using OpenShift AI</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://github.com/RedHatQuickCourses/changeme/issues" target="_blank">Report Issues</a>
      </div>
    </div>
  </nav>
</header><div class="body">
<div class="nav-container" data-component="model-serving" data-version="1.1">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Serving an LLM using OpenShift AI</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../index.html">Home</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../chapter1/index.html">Technical Component Intoduction</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter1/section1.html">Red Hat OpenShift AI</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter1/section2.html">Large Language Models</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../chapter2/index.html">OpenShift AI Initilization</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter2/section1.html">Installing Red&#160;Hat OpenShift AI Using the Web Console</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter2/section2.html">Modifying the OpenShift AI TLS Certificate</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter2/section3.html">Configure the OpenShift AI Data Science Cluster</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../chapter3/index.html">OpenShift AI Configuration</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter3/section1.html">Creating OpenShift AI Resources - 1</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter3/section2.html">MinIO S3 Compatible Storage Setup</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter3/section3.html">OpeonShift AI Resources - 2</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="index.html">Jupyter Notebooks &amp; Large Language Model Inference</a>
<ul class="nav-list">
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="section1.html">Jupyter Notebooks</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="section2.html">Mistral LLM Model Inference</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../appendix/appendix.html">Knowledge Check</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../appendix/section1.html">Quiz: Components of Red Hat OpenShift AI</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../appendix/section2.html">Answers to the Quiz</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Serving an LLM using OpenShift AI</span>
    <span class="version">1.1</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../index.html">Serving an LLM using OpenShift AI</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">1.1</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Serving an LLM using OpenShift AI</a></li>
    <li><a href="index.html">Jupyter Notebooks &amp; Large Language Model Inference</a></li>
    <li><a href="section1.html">Jupyter Notebooks</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Jupyter Notebooks</h1>
<div id="preamble">
<div class="sectionbody">
<div class="videoblock">
<div class="content">
<video src="_images/llm_jupyter_v3.mp4" width="640" controls>
Your browser does not support the video tag.
</video>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_open_the_jupyter_notebook"><a class="anchor" href="#_open_the_jupyter_notebook"></a>Open the Jupyter Notebook</h2>
<div class="sectionbody">
<div class="paragraph">
<p>From the OpenShift AI ollama-model workbench dashboard:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Select the Open link to the right of the status section. When the new window opens, use the OpenShift admin user &amp; password to login to the Notebook.</p>
</li>
<li>
<p>Click <strong>Allow selected permissions</strong> button to complete login to the notebook.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If the <strong>OPEN</strong> link for the notebook is grayed out, the notebook container is still starting. This process can take a few minutes &amp; up to 20+ minutes depending on the notebook image we opted to choose.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_inside_the_jupyter_notebook"><a class="anchor" href="#_inside_the_jupyter_notebook"></a>Inside the Jupyter Notebook</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Clone the notebook file to interact with the Ollama Framework from this location: <a href="https://github.com/rh-aiservices-bu/llm-on-openshift.git" class="bare">https://github.com/rh-aiservices-bu/llm-on-openshift.git</a></p>
</div>
<div class="paragraph">
<p>Navigate to the llm-on-openshift/examples/notebooks/langchain folder:</p>
</div>
<div class="paragraph">
<p>Then open the file: <em>Langchain-Ollama-Prompt-memory.ipynb</em></p>
</div>
<div class="paragraph">
<p>Explore the notebook, and then continue.</p>
</div>
<div class="sect2">
<h3 id="_update_the_inference_endpoint"><a class="anchor" href="#_update_the_inference_endpoint"></a>Update the Inference Endpoint</h3>
<div class="paragraph">
<p>Head back to the RHOAI workbench dashboard &amp; copy the interence endpoint from our ollama-mistral model.</p>
</div>
<div class="paragraph">
<p>Return the Jupyter Notebook Environment:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Paste the inference endpoint into the Cell labeled interfence_server_url = <strong>"replace with your own inference address"</strong></p>
</li>
</ol>
</div>
<div class="imageblock unresolved">
<div class="content">
<img src="serverurl.png" alt="serverurl" width="800">
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>We can now start executing the code in the cells, starting with the set the inference server URL cell.</p>
</li>
<li>
<p>Next we run the second cell: !pip install -q langchain==0.1.14 ; there is a notice to update pip, just ignore and continue.</p>
</li>
<li>
<p>The third cell imports the langchain components that provide the libraries and programming files to interact with our LLM model.</p>
</li>
<li>
<p>In the fourth cell, place our first call to the Ollama-Mistral Framework Served by OpenShift AI.</p>
</li>
</ol>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Before we continue, we need to perform the following additional step. As mentioned, The Ollama Model Runtime we launched in OpenShift AI is a Framework that can host multiple LLM Models. It is currently running but is waiting for the command to instruct it to download Model to Serve. The following command needs to run from the OpenShift Dashboard. We are going to use the web_terminal operator to perform this next step.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_activating_the_mistral_model_in_ollama"><a class="anchor" href="#_activating_the_mistral_model_in_ollama"></a>Activating the Mistral Model in Ollama</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We will need to obtain the endpoint from the OpenShift AI model serving console. I usually just paste the text below into a cell in the Jupyter Notebook and paste the url in the code block from there.</p>
</div>
<div class="imageblock unresolved">
<div class="content">
<img src="mistral_config.png" alt="mistral config" width="640">
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">curl https://your-endpoint/api/pull \
    -k \
    -H "Content-Type: application/json" \
    -d '{"name": "mistral"}'</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Next copy the entire code snippet, and open the OpenShift Dashboard.</p>
</li>
<li>
<p>At the top right of the dashboard, locate the "&gt;_" and select it.</p>
</li>
<li>
<p>This will open the terminal window at the bottom of the dashboard.</p>
</li>
<li>
<p>Click on the Start button in the terminal window, wait for the bash..$ prompt to appear</p>
</li>
<li>
<p>Past the modified code block into the window and press enter.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The message: <strong>status: pulling manifest</strong> should appear. This begins the model downloading process.</p>
</div>
<div class="imageblock unresolved">
<div class="content">
<img src="curl_command.png" alt="curl command" width="800">
</div>
</div>
<div class="paragraph">
<p>Once the download completes, the <strong>status: success:</strong> message appears. We can now return to the Jupyter Notebook Tab in the browser and proceed.</p>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="index.html">Jupyter Notebooks &amp; Large Language Model Inference</a></span>
  <span class="next"><a href="section2.html">Mistral LLM Model Inference</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <img src="../../../_/img/rhl-logo-red.png" height="40px" alt="Red Hat"  href="https://redhat.com" >
</footer><script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
