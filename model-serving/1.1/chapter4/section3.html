<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>LLama3 LLM Model Inference :: Serving an LLM using OpenShift AI</title>
    <link rel="prev" href="section2.html">
    <meta name="generator" content="Antora 3.1.3">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://www.redhat.com" target="_blank"><img src="../../../_/img/redhat-logo.png" height="40px" alt="Red Hat"></a>
      <a class="navbar-item" style="font-size: 24px; color: white" href="../../..">Serving an LLM using OpenShift AI</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://github.com/RedHatQuickCourses/changeme/issues" target="_blank">Report Issues</a>
      </div>
    </div>
  </nav>
</header><div class="body">
<div class="nav-container" data-component="model-serving" data-version="1.1">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Serving an LLM using OpenShift AI</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../index.html">Home</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../chapter1/index.html">Technical Component Intoduction</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter1/section1.html">Red Hat OpenShift AI</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter1/section2.html">Large Language Models</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../chapter2/index.html">OpenShift AI Initialization</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter2/section1.html">Installing Red&#160;Hat OpenShift AI Using the Web Console</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter2/section2.html">Modifying the OpenShift AI TLS Certificate</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter2/section3.html">Configure the OpenShift AI Data Science Cluster</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../chapter3/index.html">OpenShift AI Configuration</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter3/section1.html">Creating OpenShift AI Resources - 1</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter3/section2.html">MinIO S3 Compatible Storage Setup</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter3/section3.html">OpenShift AI Resources - 2</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="index.html">Jupyter Notebooks &amp; LLMs</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="section1.html">Jupyter Notebooks</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="section2.html">Mistral LLM Model Inference</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="section3.html">LLama3 LLM Model Inference</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Serving an LLM using OpenShift AI</span>
    <span class="version">1.1</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../index.html">Serving an LLM using OpenShift AI</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">1.1</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Serving an LLM using OpenShift AI</a></li>
    <li><a href="index.html">Jupyter Notebooks &amp; LLMs</a></li>
    <li><a href="section3.html">LLama3 LLM Model Inference</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">LLama3 LLM Model Inference</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Experimentation with various models allows the selection of the best model for the task at hand.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_delete_existing_deployed_model"><a class="anchor" href="#_delete_existing_deployed_model"></a>Delete existing deployed model</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Return to the OpenShift AI Dashboard and ollama-model workbench</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Head to the Model section of the workbench</p>
</li>
<li>
<p>To the right of the ollama-mistral model there are three stacked dots, select the dots, then delete from the menu</p>
</li>
<li>
<p>You need to type in the <strong>ollama-mistral</strong> model name to confirm the deletion.</p>
</li>
<li>
<p>No need to wait, continue onto the next section.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_creating_the_model_server"><a class="anchor" href="#_creating_the_model_server"></a>Creating The Model Server</h2>
<div class="sectionbody">
<div class="paragraph">
<p>From the ollama-model WorkBench Dashboard in the ollama-model project, navigate to the <strong>Models</strong> section, and select Deploy Model from the <strong>Single Model Serving Platform Button</strong>.</p>
</div>
<div class="paragraph">
<p><strong>Create the model server with the following values:</strong></p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Model name: <code>ollama-llama3</code></p>
</li>
<li>
<p>Serving Runtime: <code>Ollama</code></p>
</li>
<li>
<p>Model framework: <code>Any</code></p>
</li>
<li>
<p>Model Server Size: <code>Medium</code></p>
</li>
<li>
<p>Model location data connection: <code>models</code></p>
</li>
<li>
<p>Model location path: <code>/ollama</code></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>After clicking the <strong>Deploy</strong> button at the bottom of the form, the model is added to our <strong>Models &amp; Model Server list</strong>.  When the model is available, the inference endpoint will populate &amp; the status will indicate a green checkmark.</p>
</div>
<div class="paragraph">
<p>Copy The Interence Endpoint, we need to replace the orginal inference endpoints used in our notebooks top two cells.</p>
</div>
<div class="sect2">
<h3 id="_update_the_inference_endpoints"><a class="anchor" href="#_update_the_inference_endpoints"></a>Update the Inference Endpoints</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>From the Notebook page, replace the previous inference endpoints with the ollama-llama3 endpoint</p>
</li>
<li>
<p>In the phython code cell, we also need to change the name of the large language model in the json_data section from "mistral" to <strong>"llama3"</strong></p>
</li>
<li>
<p>To load the llama3 model, we are going use the following python code to instruct the runtime to download and serve a quantized 4 bit version of the llama3 large language model.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/llama3_url.png" alt="llama3 url" width="800">
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The Ollama Model Runtime we deployed using the Single Model Serving Platform in OpenShift AI is a Framework that can host various large language models. It is currently running, but is waiting for the command to instruct the framework on which model to download and serve.  You can view the available models in <a href="https://ollama.com/library">the ollama library here.</a>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_execute_the_cells_again"><a class="anchor" href="#_execute_the_cells_again"></a>Execute the cells again</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>We can now start executing the code in the cells, begin from the top at Set inference server cell.  Click to left of the cell to activate orange indicator next to cell.  Orange indicate the cell has been modified from the original, blue will still highlight for unmodified cells.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>You will again receive the message about an unverified HTTPs request. This is because we didnâ€™t use authentication for this application.</p>
</li>
<li>
<p>The <strong>llama3</strong> model files are now being downloaded to the Ollama Framework.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Continue executing through the cells, but stop at the <strong>create the LLM instance cell</strong>.</p>
</li>
<li>
<p>For the  <strong>create the LLM instance</strong> cell, we need to change the <em>model =mistral text</em> to <strong>llama3</strong>.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/llama_llm.png" alt="llama llm" width="800">
</div>
</div>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="section2.html">Mistral LLM Model Inference</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <img src="../../../_/img/rhl-logo-red.png" height="40px" alt="Red Hat"  href="https://redhat.com" >
</footer><script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
